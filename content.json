{"meta":{"title":"LiuQianglong's Blog","subtitle":"我的学习笔记","description":"关于网络、AWS、Python的学习笔记","author":"LiuQianglong","url":"http://example.com"},"pages":[],"posts":[{"title":"Markdown语法测试","slug":"Markdown语法测试","date":"2021-01-29T16:15:21.000Z","updated":"2021-01-29T16:27:12.844Z","comments":true,"path":"2021/01/30/Markdown语法测试/","link":"","permalink":"http://example.com/2021/01/30/Markdown%E8%AF%AD%E6%B3%95%E6%B5%8B%E8%AF%95/","excerpt":"","text":"一级标题二级标题三级标题四级标题五级标题六级标题印象笔记 近日，印象笔记宣布完成重组。作为Evernote已在中国独立运营近6年的品牌，印象笔记将成为由中方控股的中美合资独立运营实体，并获得红杉宽带跨境数字产业基金首轮数亿元人民币投资。 最外层 第一层嵌套 第二层嵌套 第一项 菜鸟教程学的不仅是技术更是梦想 第二项 印象笔记官网 使用 iOS 版本印象笔记如何快速保存内容？ 启用印象笔记 Widget ——印象笔记·剪贴板 复制粘贴任意内容 * 微信 滑动到 Widget 插件区域即可完成保存印象笔记·剪贴板有什么特点？ 快：开启自动模式，可以自动保存剪贴板的任意内容 一切：只要可以复制粘贴就可以保存 有序：全部保存在「我的剪贴板」笔记本并以时间来命名 三只青蛙 第一只青蛙 第二只青蛙 第三只青蛙 帐户类型 免费帐户 标准帐户 高级帐户 帐户流量 60M 1GB 10GB 设备数目 2台 无限制 无限制 当前价格 免费 ￥8.17/月 ￥12.33/月 &#123;.line-numbers,highlight12345678910111213141516171819202122#!/usr/bin/pythonimport reline = &quot;Cats are smarter than dogs&quot;matchObj = re.match( r&#x27;(.*) are (.*?) .*&#x27;, line, re.M|re.I)if matchObj: print &quot;matchObj.group() : &quot;, matchObj.group() print &quot;matchObj.group(1) : &quot;, matchObj.group(1) print &quot;matchObj.group(2) : &quot;, matchObj.group(2)else: print &quot;No match!!&quot;list1 = [&#x27;aaa&#x27;,111,(4,5),2.01]list2 = [&#x27;bbb&#x27;,333,111,3.14,(4,5)]for x in list1: if x in list2: print(x,&#x27;in list1 and list2&#x27;) else: print(x,&#x27;only in list1&#x27;) 使用 Ctrl+Alt+Del 重启电脑 文本加粗** 正常显示星号 ** 这会是 斜体 的文字这会是 斜体 的文字 这会是 粗体 的文字这会是 粗体 的文字 你也 组合 这些符号 这个文字将会被横线删除 Item 1 Item 2 Item 2a Item 2b Item 1 Item 2 Item 3 Item 3a Item 3b 如下，三个或者更多的 连字符 星号 下划线 &#123;highlight123``````javascript &#123;highlight=10-20&#125; &#123;highlight1 ==高亮== 这个链接用 1 作为网址变量 [RUNOOB][1].然后在文档的结尾位变量赋值（网址）[1]: http://static.runoob.com/images/runoob-logo.png 我是黑体字我是微软雅黑我是华文彩云我是红色我是绿色我是蓝色我是尺寸我是黑体，绿色，尺寸为5 文字背景颜色背景色yellow","categories":[{"name":"Tools","slug":"Tools","permalink":"http://example.com/categories/Tools/"}],"tags":[{"name":"Markdown","slug":"Markdown","permalink":"http://example.com/tags/Markdown/"}],"keywords":[{"name":"Tools","slug":"Tools","permalink":"http://example.com/categories/Tools/"}]},{"title":"AWS上配置Cisco ASAv AnyConnect","slug":"AWS上配置Cisco-ASAv-AnyConnect","date":"2021-01-29T02:09:31.000Z","updated":"2021-01-29T16:05:14.793Z","comments":true,"path":"2021/01/29/AWS上配置Cisco-ASAv-AnyConnect/","link":"","permalink":"http://example.com/2021/01/29/AWS%E4%B8%8A%E9%85%8D%E7%BD%AECisco-ASAv-AnyConnect/","excerpt":"","text":"实验简介在AWS中国区下，对Cisco ASAv进行初始化配置，让用户能通过AnyConnect拨号后通过SSL加密访问私有云网络。注意：如果ASAv未购买License会限速100k并且最大会话100个，做实验足够了但是无法用于生产环境。在中国区如果AWS账号未经过ICP备案则无法使用TCP 443端口，即https默认的443端口需要修改才能拨号成功。 环境介绍本次实验在VPC内需要使用2个子网，一个公共子网用于连接跳板机，用户可以先连接Windows2016之后，在Windows2016通过SSH和ASDM连接ASAv。这里不介绍AWS相关基础知识，例如如何创建VPC、如何创建公有子网、私有子网。 这是实验将会用到的公有子网，默认路由指向了IGW。 配置跳板机环境在公有子网启用一台window2016，用于之后通过SSH和ASDM访问ASAv，注意实例要选择windows 2016，经过测试windows 2019 无法安装ASDM。 通过AWS的快速启动一台windows 2016，可以通过输入“windows 2016”过滤查找。注意，window 2019环境无法安装Cisco ASDM。 Window2016放置在公有子网，并且开启分配公有IP功能。 创建ASAv实例在AWS Marketplace搜索asav，选择ami启用即可。需要注意的是，ASAv默认eth0是ciscoasa的管理接口，管理接口只能走网管流量，不能传输数据流量，所以至少需要再添加一个eth1作为outside接口。如果需要添加更多接口，例如inside和dmz接口，可以添加「网络接口」然后附加到实例。其实在AWS环境中一个outside接口就可以运行AnyConnect环境了。 实例创建成功之后，在AWS环境下需要对实例进行一下配置。因为AWS接口默认会丢弃目的IP不是本接口IP的流量，所以想要ASA转发流量，必须关闭outside接口的源/目标检查。 如果客户端想要访问私有云内的服务器，那么不能直接使用ASAv分配的地址池去访问，否则服务器没有回包路由。解决方法是在ASAv做源NAT，将客户端的源IP地址转换成outside上的一个辅助IP地址（无法转换成outside接口地址）。 防火墙outside需要公网能直接访问，所以需要一个公网地址。 公网地址关联上防火墙的outside接口。 启动之后，eth0是管理接口，首次连接时只能连接这个管理接口，如果想要连接其他接口可以连接之后配置。 ASAv基础配置首先通过SSH连接到ASAv的管理口进行一些基础配置，这里我使用MobaXterm作为SSH客户端，下载地址会放在最后。在AWS上启动的ASAv默认用户名是admin，使用对应的密钥登录即可。 首先需要设置enable密码 123456ciscoasa&gt; enableThe enable password is not set. Please set it now.Enter Password: ****Repeat Password: ****Note: Save your configuration so that the password persists across reboots(&quot;write memory&quot; or &quot;copy running-config startup-config&quot;). 添加的eth1接口默认是down状态 12345ciscoasa# show interface ip briefInterface IP-Address OK? Method Status ProtocolInternal-Data0&#x2F;0 169.254.1.1 YES unset up upManagement0&#x2F;0 172.30.2.176 YES DHCP up upTenGigabitEthernet0&#x2F;0 172.30.1.7 YES CONFIG administratively down up 开启eth1，配置名称为outside 123interface TenGigabitEthernet0&#x2F;0 no shutdown nameif outside 想要通过ASDM连接ASAv，需要开启http服务器，并且允许http流量从管理口进入，0 0 表示不限制IP地址段，如果要限制只允许192.168.1.0/24网段的http连接可以这么配置http 192.168.1.0 255.255.255.0。配置http的认证方式是本地认证，配置一个本地15级权限的用户名密码。 1234http server enablehttp 0 0 managementaaa authentication http console LOCALusername cisco password ciscoasa privilege 15 通过网页访问ASAv的管理接口地址 先下载并且安装Java环境，然后下载安装ASDM软件。 下载安装ASDM环境。 使用本地15级账号密码登录。 未导入License的情况下，限速100Kbps，最大会话100个连接。 这里通过ASDM的文件管理功能导入AnyConnect文件。 导入本地的AnyConnect客户端。 查看磁盘确认有客户端文件。 123ciscoasa# dirDirectory of disk0:&#x2F;86 -rwx 41077110 08:00:10 Jan 12 2021 anyconnect-win-4.6.00362-webdeploy-k9.pkg ASAv配置SSLVPN（AnyConnect）下面是在AWS上配置ASAv几乎最小化配置了，这里对AnyConnect高级功能不做讨论。按照配置思路描述一下下面命令的含义：当客户端访问其他任何地址时，源地址转换为172.30.1.5。 12345object network asa_outside_address host 172.30.1.5object network anyconnect_pool_object subnet 192.168.1.0 255.255.255.0nat (outside,outside) source dynamic anyconnect_pool_object pat-pool asa_outside_address 默认情况下ASAv相同安全级别不能访问，流量不能从相同接口进出，这里需要开启这2个特性。 12same-security-traffic permit inter-interfacesame-security-traffic permit intra-interface 创建客户端的地址池 1ip local pool anyconnect_client_pool 192.168.1.1-192.168.1.254 mask 255.255.255.255 定义隧道分隔地址段，只有当用户访问172.30.1.0/24时，流量才会通过隧道到达ASAv，其他网段流量客户端依然从本地网络出去。 1access-list anyconnect_split standard permit 172.30.1.0 255.255.255.0 开启webvpn功能，修改端口为8443，激活anyconnect拨号功能。 12345webvpn port 8443 enable outside anyconnect enable anyconnect image disk0:&#x2F;anyconnect-win-4.6.00362-webdeploy-k9.pkg 配置group-policy，运行通过网页和客户端拨入，定义流量为隧道分隔模式。 123456group-policy anyconnect internalgroup-policy anyconnect attributes vpn-tunnel-protocol ssl-client ssl-clientless split-tunnel-policy tunnelspecified split-tunnel-network-list value anyconnect_split address-pools value anyconnect_client_pool 创建一个本地账号，用于拨号 123username anyuser password ciscoasausername anyuser attributes vpn-group-policy anyconnect 目前防火墙的默认路由是通过管理接口DHCP获取到的，需要将默认路由修改为outside出去。修改步骤如下： 开启outside ssh管理 将管理接口配置为静态IP，获取的默认路由会自动消失 重新通过outside接口连接ciscoasa 指定默认路由出口为outside 查看现有默认路由通过mgmt接口出去 123456ciscoasa# show routeS* 0.0.0.0 0.0.0.0 [1&#x2F;0] via 172.30.2.1, managementC 172.30.1.0 255.255.255.0 is directly connected, outsideL 172.30.1.7 255.255.255.255 is directly connected, outsideC 172.30.2.0 255.255.255.0 is directly connected, managementL 172.30.2.176 255.255.255.255 is directly connected, management 允许ssh连接outside接口 1ssh 0 0 outside 将管理接口配置为静态地址，获取的默认路由会自动消失。 12interface management 0&#x2F;0 ip address 172.30.2.176 255.255.255.0 重新通过SSH连接上outside接口之后，添加默认路由从outside接口出去。 1route outside 0 0 172.30.1.1 默认情况下AnyConnect不允许通过远程桌面拨号，需要创建一个AnyConnect Client Profile文件，编辑里面的参数。 允许通过远程桌面拨号。 如果未修改这个参数，通过远程桌面拨号后会有如下报错。 测试AnyConnect拨号拨号成功后，我通过SSL通道能访问到Windows2016的内网地址即可证明访问成功。Windows2016需要关闭防火墙才能ping通。 安全组也需要放行ICMP协议。 在公网上拨号成功。 去往172.30.1.0/24网段的流量会通过加密隧道访问。 测试访问内网Windows2016 1234567C:\\Users\\Administrator&gt;ping 172.30.1.131正在 Ping 172.30.1.131 具有 32 字节的数据:来自 172.30.1.131 的回复: 字节&#x3D;32 时间&#x3D;1ms TTL&#x3D;128来自 172.30.1.131 的回复: 字节&#x3D;32 时间&#x3D;1ms TTL&#x3D;128来自 172.30.1.131 的回复: 字节&#x3D;32 时间&#x3D;1ms TTL&#x3D;128来自 172.30.1.131 的回复: 字节&#x3D;32 时间&#x3D;1ms TTL&#x3D;128 这里默认是TLS，也就是TCP建立的连接，如果网络环境不太稳定，需要走语音和视频流量，建议使用DTLS通道，也就是UDP连接。 修改DTLS端口为8443 12webvpn dtls port 8443 在group-policy下开启DTLS 123group-policy anyconnect attributes webvpn anyconnect ssl dtls enable 重新拨号查看协议。 ASAv上查看客户端信息 123456789101112131415161718ciscoasa(config)# show vpn-sessiondb anyconnectSession Type: AnyConnectUsername : anyuser Index : 3Assigned IP : 192.168.1.1 Public IP : 52.83.196.213Protocol : AnyConnect-Parent SSL-TunnelLicense : AnyConnect PremiumEncryption : AnyConnect-Parent: (1)none SSL-Tunnel: (1)AES-GCM-256Hashing : AnyConnect-Parent: (1)none SSL-Tunnel: (1)SHA384Bytes Tx : 18613 Bytes Rx : 7928Group Policy : anyconnect Tunnel Group : DefaultWEBVPNGroupLogin Time : 09:46:43 UTC Tue Jan 12 2021Duration : 0h:01m:51sInactivity : 0h:00m:00sVLAN Mapping : N/A VLAN : noneAudt Sess ID : ac1e02b0000030005ffd7003Security Grp : none 1、mobaxterm下载地址2、Java环境下载地址","categories":[{"name":"Network","slug":"Network","permalink":"http://example.com/categories/Network/"}],"tags":[{"name":"Cisco","slug":"Cisco","permalink":"http://example.com/tags/Cisco/"},{"name":"AnyConnect","slug":"AnyConnect","permalink":"http://example.com/tags/AnyConnect/"},{"name":"AWS","slug":"AWS","permalink":"http://example.com/tags/AWS/"},{"name":"SSLVPN","slug":"SSLVPN","permalink":"http://example.com/tags/SSLVPN/"}],"keywords":[{"name":"Network","slug":"Network","permalink":"http://example.com/categories/Network/"}]}]}